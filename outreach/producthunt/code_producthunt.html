<!DOCTYPE html>
<html>
<head>
<title></title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style type="text/css">
body{
	margin: 0px;
	font-size: 16px;
	font-family: 'courier new', sans-serif;
	background-color: #333;
	color: #eee;
}


.folders{
	display: none;
	position: fixed;
	left: 0px;
	top: 0px;
	height: 100%;
	width: 200px;
	overflow: scroll;
	background-color: #555;
	padding: 20px 0px;
	box-sizing: border-box;
}
.folders_title{
	padding: 0px 10px;
	margin-bottom: 10px;
}

.folders a{
	color: #eee;
	display: block;
	border-bottom: 1px solid #999;
	padding: 10px 20px;
	text-decoration: none;
	font-size: 14px;
}
.folders a:hover{
	background-color: #333;
}







.code_container{
	margin: 0px;
	padding: 20px;
	max-width: 100%;
	white-space: pre-wrap;
	font-size: 1em;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;
}

.product_link{
	color: #eee;
	text-decoration: none;
}
.product_link:hover{
	color: #8de;
}
.preview{
	display: none;
	max-width: 300px;
	position: fixed;
	right: 5px;
	top: 5px;
	border: 3px solid #666;
	border-radius: 2px;
	text-align: center;
	overflow: hidden;
}
.preview_image{
	/* ratio 1480 x 1037 */
	width: 300px;
	height: 210px;
	display: block;
	background-size: cover;
}
.preview_title{
	background-color: #eee;
	color: #444;
	padding: 10px;
	display: block;
	position: relative;
	box-shadow: 0px 1px 3px -1px rgba(33,33,33,0.8);
}

@media(min-width: 750px){
	.folders{
		display: block;
	}
	.code_container{
		margin-left: 200px;
	}
	.product_link:hover .preview{
		display: block;
	}
}






.tagname{
	color: #f29;
}
.attribute_name{
	color: #ae7;
}
.attribute_value{
	color: #ed8;
}

</style>

</head>
<body>



<div class="folders">
	<div class="folders_title">Folders</div>
	<a href="#" class="topic_link" data-topic="">Front Page</a>
	<a href="#" class="topic_link" data-topic="games">Games</a>
</div>

<pre class="code_container">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;HTML Product Hunt&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

<div id="output">Loading...</div>

&lt;/body&gt;
&lt;/html&gt;
</pre>





<script>
function highlightSyntax(html){
	html = html.replace(/(&lt;\/*)(\w+)((.(?!gt;))*)/gi, replacer);
	function replacer(value, p1, p2, p3){

		// within each tag, highlight the attributes		
		p3 = p3 ? p3.replace(/\s([\w-]+)=("[^"]*")/gi,
			' <span class="attribute_name">$1</span>='
			+'<span class="attribute_value">$2</span>')
			: '';

		// put attributes into main tag and return the result
		var result = p1+'<span class="tagname">'+p2+'</span>'+p3;
		return result;
	}
	return html;
}

// highlight initial syntax
(function(){
	var initial_html = document.querySelector('.code_container').innerHTML;
	document.querySelector('.code_container').innerHTML = highlightSyntax(initial_html);
})();







// start app

var token = 'b1456a4abc645fd8b5ecd88f98695ab3df7678695ae9b82a39b58cd667ea1518';
var url = 'https://api.producthunt.com/v1/posts?access_token='+token;


var outputdiv = document.getElementById('output');




function getJSON(url, callback, topic){

	outputdiv.innerHTML = 'Loading...';


	var data_title = topic ? 'producthunt_data_'+topic : 'producthunt_data';

	if(!sessionStorage[data_title]){
		var xhr = new XMLHttpRequest();
		xhr.onreadystatechange = function(){
			if(this.readyState==4 && this.status==200){
				var response = this.responseText;
				sessionStorage.setItem(data_title, response);

				var json_data = JSON.parse(response);
				callback(json_data);
			}
		};
		xhr.open('GET', url, true);
		xhr.send();
	}

	else{
		var data = JSON.parse(sessionStorage[data_title]);
		callback(data);
	}
}

getJSON(url, showData);



function showData(data){

	var html = [];

	var posts = data.posts;
	posts.forEach(function(v){
		var entry = ''
				+ '&lt;div&gt;\n'
					
					// product
					// + '<img src="'+v.screenshot_url['300px']+'" style="max-width:400px;" alt="">\n'
					+ '\t&lt;h2 class="product" data-votes="'+v.votes_count+'" data-comments="'+v.comments_count+'"&gt;\n'
						+ '\t\t<a class="product_link" href="'+v.discussion_url+'" target="_blank">'
							+v.name+' <span class="tagline">- '+v.tagline+'</span>'
							+'<span class="preview">'
								+'<span class="preview_title">Quick Preview:</span>'
								+'<span class="preview_image" style="background-image:url('+v.screenshot_url['300px']+')"></span>'
							+'</span>'
						+'</a>\n'
					+ '\t&lt;/h2&gt;\n'

				+ '&lt;/div&gt;\n';

		entry = highlightSyntax(entry);
		html.push(entry);
	});

	outputdiv.innerHTML = html.join('');
}



function showComments(){
	/*
	sample url:
	https://api.producthunt.com/v1/posts/104582/comments?access_token=b1456a4abc645fd8b5ecd88f98695ab3df7678695ae9b82a39b58cd667ea1518

	code:
	var token = 'b1456a4abc645fd8b5ecd88f98695ab3df7678695ae9b82a39b58cd667ea1518';
	var post_id = '104582';
	var url = 'https://api.producthunt.com/v1/posts/'+post_id+'/comments?access_token='+token;
	*/
}


function showPostsByTopic(topic){
	/*
	sample url for tech topic:
	https://api.producthunt.com/v1/posts/all?access_token=b1456a4abc645fd8b5ecd88f98695ab3df7678695ae9b82a39b58cd667ea1518&search[topic]=productivity

	code:
	var token = 'b1456a4abc645fd8b5ecd88f98695ab3df7678695ae9b82a39b58cd667ea1518';
	var topic = 'tech';
	var url = 'https://api.producthunt.com/v1/posts/all?access_token='+token+'&search[topic]='+topic;
	*/

	var token = 'b1456a4abc645fd8b5ecd88f98695ab3df7678695ae9b82a39b58cd667ea1518';
	var url = 'https://api.producthunt.com/v1/posts/all?access_token='+token+'&search[topic]='+topic;

	getJSON(url, showData, topic);
}




document.querySelectorAll('.topic_link').forEach(function(v){
	v.onclick = function(){
		showPostsByTopic(this.getAttribute('data-topic'));
		return false;
	}
});




</script>
</body>
</html>